
@using NicePictureStudioReporting
<!DOCTYPE html>

@*@section styles
{
    <link href= @Url.Content("~/Scripts/ReportViewer/styles/telerikReportViewer-8.1.14.804.css") rel="stylesheet" />
    <style>
        #reportViewer1 {
            position: absolute;
            left: 5px;
            right: 5px;
            top: 50px;
            bottom: 5px;
            overflow: hidden;
        }
    </style>
   
}

@section scripts
{
    <script src=@Url.Content("~/Scripts/ReportViewer/js/telerikReportViewer-8.1.14.804.js")></script>
}

@{
    var typeReportSource = new TypeReportSource() { TypeName = typeof(CRMCustomerRelationReport).AssemblyQualifiedName };
    typeReportSource.Parameters.Add("ServiceId", 6);
}

@(Html.TelerikReporting().ReportViewer()
        .Id("reportViewer1")
        .ServiceUrl("/api/reports/")
        .TemplateUrl(@Url.Content("~/Scripts/ReportViewer/templates/telerikReportViewerTemplate-8.1.14.804.html"))
        //.ReportSource(new TypeReportSource() { TypeName = typeof(CRMCustomerRelationReport).AssemblyQualifiedName})
        .ReportSource(typeReportSource)
        .ViewMode(ViewModes.PRINT_PREVIEW)
        .ScaleMode(ScaleModes.SPECIFIC)
        .Scale(1.0)
        .PersistSession(true)


)*@

@*@(Html.Kendo().PivotConfigurator()
    .Name("configurator")
    .Filterable(true)
)

@(Html.Kendo().PivotGrid()
      .Name("pivotgrid")
      .DataSource(dataSource => dataSource.
          Xmla()
          .Columns(columns =>
          {
             columns.Add("[Date].[Calendar]").Expand(true);
             columns.Add("[Geography].[City]");
          })
          .Rows(rows => rows.Add("[Product].[Product]"))
          .Measures(measures => measures.Values(new string[] { "[Measures].[Internet Sales Amount]" }))
          .Transport(transport => transport
              .Connection(connection => connection
                  .Catalog("Adventure Works DW 2008R2")
                  .Cube("Adventure Works"))
              .Read(read => read
                  //  .Url(@"http://demos.telerik.com/olap/msmdpump.dll")
                      .Url(@"http://localhost/OLAP/msmdpump.dll") 
                  .DataType("text")
                  .ContentType("text/xml")
                  .Type(HttpVerbs.Post)
              )
          ).Events(e =>e.Error("onError"))
          )
          
)*@

<style>
    #pivotgrid {
        display: inline-block;
        vertical-align: top;
        width: 70%;
    }

    #configurator {
        display: inline-block;
        vertical-align: top;
    }
</style>


<script>
    function onError(e) {
        alert("error: " + kendo.stringify(e));
    }
</script>

@(Html.Kendo().PivotGrid()
      .Name("pivotgrid")
      .DataSource(dataSource => dataSource.
          Xmla()
          .Columns(columns =>
          {
              columns.Add("[Dimension Time].[Month]").Expand(true);
              //columns.Add("[Geography].[City]");
          })
          //.Rows(rows => rows.Add("[Promotion].[Profit]"))
              .Measures(measures => measures.Values(new string[] { "[Measures].[Sale Amount]" }))
          .Transport(transport => transport
              .Connection(connection => connection
                           .Catalog("NC Studio DW")
                       .Cube("NC Studio DW"))
              .Read(read => read
                  .Url(@"http://localhost:80/olap/msmdpump.dll")
                  .DataType("text")
                  .ContentType("text/xml")
                  .Type(HttpVerbs.Post)
              )
              ).Events(e => e.Error("onError"))
      )
)