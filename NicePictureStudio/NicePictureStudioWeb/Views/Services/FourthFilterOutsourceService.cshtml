<script type="text/javascript">
    $(document).ready(function () {
        
        $("#dwnServicePattern").on("change", function (item) {
            event.preventDefault();
            var selectedItem = $("#dwnServicePattern").val();
            //alert(selectedItem);
            $.ajax({
                url: '@Url.Action("CreateOutsourceServiceByModal", "Services")',
                data: { id: selectedItem, serviceType: '@ViewData["SType"]' },
                type: "GET",
                success: function (data) { $("#divOutsource").replaceWith(data); }
            });
        });
    });

   
</script>

<div id="ServiceSelection">
    <div class="panel panel-default">
        <div class="panel-heading">ตัวเลือกต่างๆ</div>
        <div class="panel-info">
            <table class="table table-responsive">
                <tr>
                    <td>
                        <div class="form-horizontal">
                            <div class="form-group-sm">
                                <div><label class="control-label">ประเภทของการให้บริการ</label></div>
                                <div>
                                    @*@Html.Kendo().DropDownList().Name("OutsourceCatalog").HtmlAttributes(new { @id = "dwnOutsourceCatalog" }).BindTo(*@
                                                           @*new string[] { "ช่างถ่ายภาพ", "ช่างถ่าพภาพวีดีโอ", "ช่างแต่งหน้า", "เช่าชุดแต่งงาน", "ของที่ระลึกวันแต่งงาน" })*@
                                    @(Html.Kendo().DropDownList()
                                         .Name("OutsourceServiceCatalogs")
                                      .HtmlAttributes(new { style = "width:250px" })
                                      .OptionLabel("กรุณาเลือกประเภทของบริการจัดจ้าง")
                                              .DataTextField("OutsourceTypeName")
                                              .DataValueField("OutsourceTypeId")
                                      .DataSource(source =>
                                      {
                                          source.Read(read =>
                                          {
                                              read.Action("OutsourceServiceType_Read", "Services");
                                          });
                                      })
                                    )

                            </div>
                        </div>
                        <div class="form-group-sm">
                            <div><label class="control-label">ช่วงราคาค่าบริการ</label></div>
                            <div>
                                @*@Html.Kendo().DropDownList().Name("OutsourceType").HtmlAttributes(new { @id = "dwnOutsourceType" }).BindTo(
                                                           new string[] { "5000-15000", "10000-25000", "20000-35000", "มากกว่า 45000" })*@

                                <script>
                                    function filterOutsourceType() {
                                        return {
                                            outsourceTypeId: $("#OutsourceServiceCatalogs").val()
                                        };
                                    }
                                </script>

                                @(Html.Kendo().DropDownList()
                                          .Name("OutsourceServiceRange")
                                          .HtmlAttributes(new { style = "width:250px" })
                                          .OptionLabel("กรุณาเลือกช่วงราคา")
                                                  .DataTextField("OutsourcePriceRangeName")
                                                  .DataValueField("OutsourcePriceRangeId")
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("OutsourceServiceRange_Read", "Services").Data("filterOutsourceType");
                                              })
                                              .ServerFiltering(true);
                                          })
                                          .Enable(false)
                                          .AutoBind(false)
                                          .CascadeFrom("OutsourceServiceCatalogs")
                                )

                        </div>
                    </div>
                    <hr />
                     @*<h6>ตัวเบือกจากช่สงราคาแบบกำหนดเอง</h6>
                    <div class="form-group-sm">
                        <div>ช่วงราคาจาก</div>
                        <div>@Html.Kendo().NumericTextBox().Name("OutsourcePriceLower").Min(5000).Max(100000).Format("D").Value(5000)</div>
                    </div>
                    <div class="form-group-sm">
                        <div>ถึง</div>
                        <div>@Html.Kendo().NumericTextBox().Name("OutsourcePriceHigher").Min(5000).Max(100000).Format("D").Value(5000)</div>
                    </div>*@

                    <div class="form-group-sm">
                        @*@Html.Label("สถานที่", htmlAttributes: new { @class = "control-label col-md-2" })*@
                        <div><label class="control-label">บริการจัดจ้าง</label></div>
                        <div class="list-group col-md-10">
                            @*@Html.DropDownList("Code", @ViewData["OutputList"] as IEnumerable<SelectListItem>, htmlAttributes: new { @class = "form-group", @id = "dwnServicePattern", @name = "dwnServicePattern" })*@
                            @*@Html.Kendo().DropDownList().Name("dwnServicePattern").BindTo(@ViewData["OutsourceList"] as IEnumerable<SelectListItem>).HtmlAttributes(new { @id = "dwnServicePattern" }).SelectedIndex(Convert.ToInt32(@ViewData["Code"]))*@

                            <script>
                                function filterOutsourceTypeAndPrice() {
                                    return {
                                        outsourceCatalogId: $("#OutsourceServiceCatalogs").val(), outsourcPriceId: $("#OutsourceServiceRange").val()
                                    };
                                }
                            </script>

                            @(Html.Kendo().DropDownList()
                                          .Name("dwnServicePattern")
                                          .HtmlAttributes(new { @style = "width:180px", @id = "dwnServicePattern" })
                                          .OptionLabel("กรุณาเลือกบริการ")
                                                  .DataTextField("OutsourceServiceName")
                                                  .DataValueField("OutsourceServiceID")
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("OutsourceServices_read", "Services")
                                                      .Data("filterOutsourceTypeAndPrice");
                                              })
                                              .ServerFiltering(true);
                                          })
                                          .Enable(false)
                                          .AutoBind(false)
                                                          .CascadeFrom("OutsourceServiceRange")
                            )

                        </div>
                    </div>
                </div>
            </td>
            <td>
                <div class="form-horizontal container-fluid">
                    <div class="row">
                        <a href="#" class="img-rounded">
                            <img src="@Url.Content("~/Content/images/PhotoGraph/Cover/PhotoGraphCover8.jpg")" class="img-thumbnail" />
                        </a>
                    </div>
                </div>
            </td>
        </tr>
    </table>
    </div>
        <div class="panel-body">
            @{Html.RenderAction("CreateOutsourceServiceByModal", "Services", new { id = @ViewData["Code"], ServiceType = @ViewData["SType"] });}
        </div>
    </div>
</div>